var g=Object.defineProperty;var m=(t,s,e)=>s in t?g(t,s,{enumerable:!0,configurable:!0,writable:!0,value:e}):t[s]=e;var l=(t,s,e)=>m(t,typeof s!="symbol"?s+"":s,e);import{k as p}from"../../assets/index-chunk.js";import{i as w,K as v}from"../../assets/index-chunk10.js";import{t as b}from"../../assets/index-chunk3.js";import"../input/slds/input-label/input-label.slds.js";import{E as _,C as y,a as E,g as P,i as T,b as k,n as C,c as R,e as V,R as d,D as u,B as D,S as x,T as S,M as B,I,d as F,f as M}from"./ckeditor-config.js";import{N}from"./input-rich-text.js";import"../../assets/index-chunk8.js";import"../../assets/index-chunk6.js";import"../../assets/index-chunk2.js";/**
 * @license Copyright (c) 2003-2024, CKSource Holding sp. z o.o. All rights reserved.
 * For licensing, see LICENSE.md or https://ckeditor.com/legal/ckeditor-oss-license
 */class K extends k{constructor(e,i){super(e);l(this,"view");l(this,"_toolbarConfig");l(this,"_elementReplacer");this.view=i,this._toolbarConfig=C(e.config.get("toolbar")),this._elementReplacer=new R,this.listenTo(e.editing.view,"scrollToTheSelection",this._handleScrollToTheSelectionWithStickyPanel.bind(this))}get element(){return this.view.element}init(e){const i=this.editor,o=this.view,n=i.editing.view,a=o.editable,r=n.document.getRoot();a.name=r.rootName,o.render();const h=a.element;this.setEditableElement(a.name,h),o.editable.bind("isFocused").to(this.focusTracker),n.attachDomRoot(h),e&&this._elementReplacer.replace(e,this.element),this._initPlaceholder(),this._initToolbar(),o.menuBarView&&this._initMenuBar(o.menuBarView),this._initDialogPluginIntegration(),this.fire("ready")}destroy(){super.destroy();const e=this.view,i=this.editor.editing.view;this._elementReplacer.restore(),i.detachDomRoot(e.editable.name),e.destroy()}_initToolbar(){const e=this.view;e.stickyPanel.bind("isActive").to(this.focusTracker,"isFocused"),e.stickyPanel.limiterElement=e.element,e.stickyPanel.bind("viewportTopOffset").to(this,"viewportOffset",({top:i})=>i||0),e.toolbar.fillFromConfig(this._toolbarConfig,this.componentFactory),this.addToolbar(e.toolbar)}_initPlaceholder(){const e=this.editor,i=e.editing.view,o=i.document.getRoot(),n=e.sourceElement;let a;const r=e.config.get("placeholder");r&&(a=typeof r=="string"?r:r[this.view.editable.name]),!a&&n&&n.tagName.toLowerCase()==="textarea"&&(a=n.getAttribute("placeholder")),a&&(o.placeholder=a),V({view:i,element:o,isDirectHost:!1,keepOnFocus:!0})}_handleScrollToTheSelectionWithStickyPanel(e,i,o){const n=this.view.stickyPanel;if(n.isSticky){const a=new d(n.element).height;i.viewportOffset.top+=a}else{const a=()=>{this.editor.editing.view.scrollToTheSelection(o)};this.listenTo(n,"change:isSticky",a),setTimeout(()=>{this.stopListening(n,"change:isSticky",a)},20)}}_initDialogPluginIntegration(){if(!this.editor.plugins.has("Dialog"))return;const e=this.view.stickyPanel,i=this.editor.plugins.get("Dialog");i.on("show",()=>{const o=i.view;o.on("moveTo",(n,a)=>{if(!e.isSticky||o.wasMoved)return;const r=new d(e.contentPanelElement);a[1]<r.bottom+u.defaultOffset&&(a[1]=r.bottom+u.defaultOffset)},{priority:"high"})},{priority:"low"})}}class U extends D{constructor(e,i,o={}){super(e);l(this,"stickyPanel");l(this,"toolbar");l(this,"editable");this.stickyPanel=new x(e),this.toolbar=new S(e,{shouldGroupWhenFull:o.shouldToolbarGroupWhenFull}),o.useMenuBar&&(this.menuBarView=new B(e)),this.editable=new I(e,i)}render(){super.render(),this.menuBarView?this.stickyPanel.content.addMany([this.menuBarView,this.toolbar]):this.stickyPanel.content.add(this.toolbar),this.top.add(this.stickyPanel),this.main.add(this.editable)}}class W extends _(F){constructor(e,i={}){if(!c(e)&&i.initialData!==void 0)throw new y("editor-create-initial-data",null);super(i);l(this,"ui");this.config.define("menuBar.isVisible",!1),this.config.get("initialData")===void 0&&this.config.set("initialData",G(e)),c(e)&&(this.sourceElement=e),this.model.document.createRoot();const o=!this.config.get("toolbar.shouldNotGroupWhenFull"),n=this.config.get("menuBar"),a=new U(this.locale,this.editing.view,{shouldToolbarGroupWhenFull:o,useMenuBar:n.isVisible});this.ui=new K(this,a),E(this)}destroy(){return this.sourceElement&&this.updateSourceElement(),this.ui.destroy(),super.destroy()}static create(e,i={}){return new Promise(o=>{const n=new this(e,i);o(n.initPlugins().then(()=>n.ui.init(c(e)?e:null)).then(()=>n.data.init(n.config.get("initialData"))).then(()=>n.fire("ready")).then(()=>n))})}}function G(t){return c(t)?P(t):t}function c(t){return T(t)}var O=Object.defineProperty,j=Object.getOwnPropertyDescriptor,A=(t,s,e,i)=>{for(var o=i>1?void 0:i?j(s,e):s,n=t.length-1,a;n>=0;n--)(a=t[n])&&(o=(i?a(s,e,o):a(o))||o);return i&&o&&O(s,e,o),o};let f=class extends N{constructor(){super(...arguments),this._ckEditor=void 0,this._editorRef=w(),this._externalDataChange=!1}createRenderRoot(){return this}async firstUpdated(){const t=this._editorRef.value;if(t===void 0){console.error("CKEditor host element is undefined");return}const s=await W.create(t,{...M,placeholder:this.placeholder??void 0});s.setData(this.value??""),this._registerCKEditorEvents(s),this._ckEditor=s}_registerCKEditorEvents(t){let s=e=>{this._externalDataChange||this.dispatchEvent(new CustomEvent("change",{bubbles:!0,composed:!0,detail:{value:e}})),this._externalDataChange=!1};this.debounce>0&&(s=H(s,this.debounce)),t.model.document.on("change:data",()=>s(t.getData()))}updated(t){if(super.updated(t),this._ckEditor!==void 0&&(t.get("value")!==this.value&&this._ckEditor.getData()!==this.value&&(this._externalDataChange=!0,this._ckEditor.setData(this.value??"")),t.get("placeholder")!==this.placeholder)){const s=this._ckEditor.editing.view.document.getRoot("main");s.placeholder=this.placeholder??void 0}}render(){return p`
            <nsc-input-label>${this.label}</nsc-input-label>
            <div ${v(this._editorRef)}></div>
        `}};f=A([b("nsc-input-rich-text")],f);function H(t,s=300){let e;return i=>{clearTimeout(e),e=setTimeout(()=>t(i),s)}}export{f as N};
